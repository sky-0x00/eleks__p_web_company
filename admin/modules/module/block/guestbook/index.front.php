<?php
include_once ( $cfg['PATH']['admin_modules_path'] . "guestbook/classes/GuestBook.class.php" );

$GuestBook = new GuestBook();

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	≈сли страница по-умолчанию
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

if (count($PARAMS)==0) {
	$messages 	= $GuestBook -> GetMessages(0, 1);
	$pages 		= $GuestBook -> GetPages(0);
}

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	≈сли страница категории без указани€ страницы
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		
elseif (count($PARAMS)==1) {
	$messages 	= $GuestBook -> GetMessages($PARAMS[0], 1);
	$pages 		= $GuestBook -> GetPages($PARAMS[0]);	
}
		
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	≈сли страница категории с указанием страницы
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

elseif (count($PARAMS)==2) {
	$messages 	= $GuestBook -> GetMessages($PARAMS[0], $PARAMS[1]);
	$pages 		= $GuestBook -> GetPages($PARAMS[0]);	
}

if (count($pages)>1) {
	$tpl -> assign ( "Pages", 	$pages );
	$tpl -> assign ( "Count", 	count($pages) );
}

$tpl -> assign ( "Messages", 	$messages );
$tpl -> assign ( "Cats", 		$GuestBook -> GetCategories() );
$tpl -> assign ( "PARAMS",		$PARAMS );
$tpl -> assign ( "module_guestbook", $tpl->fetch($cfg['PATH']['admin_modules_path'] . "guestbook/templates/front.tpl.php") );
?>